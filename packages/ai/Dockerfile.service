FROM python:3.12-slim

WORKDIR /app
COPY . .
RUN rm -rf build dist *.egg-info llm_demo/*.egg-info
RUN pip install --no-cache-dir -r requirements.txt

CMD ["sh", "-c", "gunicorn llm_demo.main:app \
  --worker-class uvicorn.workers.UvicornWorker \
  --bind 0.0.0.0:$PORT \
  --workers 2 \
  --threads 4"]
